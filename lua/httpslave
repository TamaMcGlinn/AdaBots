local server = "http://localhost:7112/"

while true do

  local request = nil
  repeat
    request = http.get(server)
    if not request then
      os.sleep(1)
    end
  until request

  local command = request.readAll()
  local functor = loadstring("return(" .. command .. ")")

  local result = nil
  if functor then
    result = tostring(functor())
  else
    result = "error: invalid lua expression"
  end
  print(command .. " returned " .. result)

  http.get(server .. "return_value/" .. result)

  request.close()

end
